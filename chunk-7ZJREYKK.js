import{a as T}from"./chunk-G4OZODC3.js";import{f as z}from"./chunk-G3ET6EPM.js";import{$ as F,W as D,Z as B,aa as K,da as Z}from"./chunk-T23V5DOL.js";import{Cb as E,Ib as x,Ka as P,Za as I,ha as y,hb as g,ib as O,jb as C,qb as _}from"./chunk-4Z65B2I4.js";var q=(()=>{let t=class t{constructor(){this.formulaElem=new F("Na2O + H2O = NaOH"),this.RANDOM_DEMOS=["H2 + O2 = H2O","Fe + O2 = Fe2O3","NH3 + O2 = N2 + H2O","C2H2 + O2 = CO2 + H2O","C3H8O + O2 = CO2 + H2O","Na + O2 = Na2O","P4 + O2 = P2O5","Na2O + H2O = NaOH","Mg + HCl = MgCl2 + H2","AgNO3 + LiOH = AgOH + LiNO3","Pb + PbO2 + H^+ + SO4^2- = PbSO4 + H2O","HNO3 + Cu = Cu(NO3)2 + H2O + NO","KNO2 + KNO3 + Cr2O3 = K2CrO4 + NO","AgNO3 + BaCl2 = Ba(NO3)2 + AgCl","Cu(NO3)2 = CuO + NO2 + O2","Al + CuSO4 = Al2(SO4)3 + Cu","Na3PO4 + Zn(NO3)2 = NaNO3 + Zn3(PO4)2","Cl2 + Ca(OH)2 = Ca(ClO)2 + CaCl2 + H2O","CHCl3 + O2 = CO2 + H2O + Cl2","H2C2O4 + MnO4^- = H2O + CO2 + MnO + OH^-","H2O2 + Cr2O7^2- = Cr^3+ + O2 + OH^-","KBr + KMnO4 + H2SO4 = Br2 + MnSO4 + K2SO4 + H2O","K2Cr2O7 + KI + H2SO4 = Cr2(SO4)3 + I2 + H2O + K2SO4","KClO3 + KBr + HCl = KCl + Br2 + H2O","Ag + HNO3 = AgNO3 + NO + H2O","P4 + OH^- + H2O = H2PO2^- + P2H4","Zn + NO3^- + H^+ = Zn^2+ + NH4^+ + H2O","ICl + H2O = Cl^- + IO3^- + I2 + H^+","AB2 + AC3 + AD5 + AE7 + AF11 + AG13 + AH17 + AI19 + AJ23 = A + ABCDEFGHIJ"],this.lastRandomIndex=-1}doBalance(){let n=document.getElementById("message"),o=document.getElementById("balanced"),r=document.getElementById("codeOutput");for(n.textContent="";o.firstChild!==null;)o.removeChild(o.firstChild);for(;r.firstChild!==null;)r.removeChild(r.firstChild);r.textContent=" ";let i=this.formulaElem.value,a;try{a=new k(i).parseEquation()}catch(l){if(l instanceof c){n.textContent="Erro ao calcular: "+l.message;let u=l.start,h=l.end!==void 0?l.end:l.start;for(;h>u&&[" ","	"].includes(i.charAt(h-1));)h--;u==h&&h++,r.textContent=i.substring(0,u),h<=i.length?(r.append(m("u",i.substring(u,h))),r.append(i.substring(h,i.length))):r.append(m("u"," "))}else l instanceof Error?n.textContent="Erro de: "+l.message:n.textContent="Erro de Afirma\xE7\xE3o";return}try{let l=j(a);J(l);let u=$(l);G(a,u),o.append(a.toHtml(u))}catch(l){n.textContent=l.message}}doDemo(n){this.formulaElem.setValue(n),this.doBalance()}doRandom(){let n;do n=Math.floor(Math.random()*this.RANDOM_DEMOS.length),n=Math.max(Math.min(n,this.RANDOM_DEMOS.length-1),0);while(this.RANDOM_DEMOS.length>=2&&n==this.lastRandomIndex);this.lastRandomIndex=n,this.doDemo(this.RANDOM_DEMOS[n])}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=y({type:t,selectors:[["app-chem-balance"]],standalone:!0,features:[x],decls:14,vars:1,consts:[[1,"form-group"],[1,"form-input"],["for","formula"],["type","text","id","formula","placeholder","Ex: H2 + O2 = H2O",1,"form-control",3,"formControl"],["formulas",""],["type","button",1,"btn","btn-primary",3,"click"],[1,"messages"],["id","message"],["id","balanced"],["id","codeOutput"]],template:function(o,r){o&1&&(g(0,"div")(1,"div",0)(2,"div")(3,"section",1)(4,"label",2),E(5,"Formula:"),O(),C(6,"input",3,4),g(8,"button",5),_("click",function(){return r.doBalance()}),E(9," Balance Equation "),O()(),g(10,"section",6),C(11,"div",7)(12,"div",8)(13,"div",9),O()()()()),o&2&&(P(6),I("formControl",r.formulaElem))},dependencies:[Z,D,B,K,z,T],styles:["[_nghost-%COMP%]   .form-input[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}[_nghost-%COMP%]   .form-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:20px}[_nghost-%COMP%]   section.form-input[_ngcontent-%COMP%]{display:grid;flex-direction:column;align-items:center;justify-content:center}[_nghost-%COMP%]   section.messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}[_nghost-%COMP%]   div#balanced[_ngcontent-%COMP%]{letter-spacing:5px;border-radius:7px;padding:20px;margin:25px 0 0}[_nghost-%COMP%]   div#balanced[_ngcontent-%COMP%]:empty{background-color:transparent;padding:0}[_nghost-%COMP%]   div#balanced[_ngcontent-%COMP%]:not(:empty){background-color:#2f4f4f;padding:35px;animation:_ngcontent-%COMP%_fade 1s normal}@keyframes _ngcontent-%COMP%_fade{0%{opacity:0}to{opacity:1}}[_nghost-%COMP%]   div#message[_ngcontent-%COMP%]{border-radius:7px;margin:15px 0 0;color:#000}[_nghost-%COMP%]   div#message[_ngcontent-%COMP%]:empty{background-color:transparent;padding:0}[_nghost-%COMP%]   div#message[_ngcontent-%COMP%]:not(:empty){background-color:orange;padding:25px;animation:_ngcontent-%COMP%_fade 1s,pulse 1s infinite;animation-delay:0s,1s}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scaleZ(1)}50%{transform:scale3d(1.05,1.05,1.05)}to{transform:scaleZ(1)}}"]});let s=t;return s})(),k=class{constructor(t){this.tok=new b(t)}parseEquation(){let t=[this.parseTerm()];for(;;){let n=this.tok.peek();if(n=="+")this.tok.consume(n),t.push(this.parseTerm());else if(n=="="){this.tok.consume(n);break}else throw new c("Plus or equal sign expected",this.tok.pos)}let e=[this.parseTerm()];for(;;){let n=this.tok.peek();if(n===null)break;if(n=="+")this.tok.consume(n),e.push(this.parseTerm());else throw new c("Plus or end expected",this.tok.pos)}return new M(t,e)}parseTerm(){let t=this.tok.pos,e=[],n=!1,o;for(;;)if(o=this.tok.peek(),o=="(")e.push(this.parseGroup());else if(o=="e")this.tok.consume(o),n=!0;else if(o!==null&&/^[A-Z][a-z]*$/.test(o))e.push(this.parseElement());else{if(o!==null&&/^[0-9]+$/.test(o))throw new c("Invalid term - number not expected",this.tok.pos);break}let r=null;if(o=="^"){if(this.tok.consume(o),o=this.tok.peek(),o===null)throw new c("Number or sign expected",this.tok.pos);if(r=this.parseOptionalNumber(),o=this.tok.peek(),o=="+")r=+r;else if(o=="-")r=-r;else throw new c("Sign expected",this.tok.pos);this.tok.take()}if(n){if(e.length>0)throw new c("Invalid term - electron needs to stand alone",t,this.tok.pos);if(r===null&&(r=-1),r!=-1)throw new c("Invalid term - invalid charge for electron",t,this.tok.pos)}else{if(e.length==0)throw new c("Invalid term - empty",t,this.tok.pos);r===null&&(r=0)}return new H(e,r)}parseGroup(){let t=this.tok.pos;this.tok.consume("(");let e=[];for(;;){let n=this.tok.peek();if(n=="(")e.push(this.parseGroup());else if(n!==null&&/^[A-Z][a-z]*$/.test(n))e.push(this.parseElement());else if(n==")"){if(this.tok.consume(n),e.length==0)throw new c("Empty group",t,this.tok.pos);break}else throw new c("Element, group, or closing parenthesis expected",this.tok.pos)}return new N(e,this.parseOptionalNumber())}parseElement(){let t=this.tok.take();if(!/^[A-Z][a-z]*$/.test(t))throw new Error("Assertion error");return new R(t,this.parseOptionalNumber())}parseOptionalNumber(){let t=this.tok.peek();return t!==null&&/^[0-9]+$/.test(t)?V(this.tok.take()):1}},b=class{constructor(t){this.str=t.replace(/\u2212/g,"-"),this.pos=0,this.skipSpaces()}peek(){if(this.pos==this.str.length)return null;let t=/^([A-Za-z][a-z]*|[0-9]+|[+\-^=()])/.exec(this.str.substring(this.pos));if(t===null)throw new c("Simbolo inserido inv\xE1lido.",this.pos);return t[0]}take(){let t=this.peek();if(t===null)throw new Error("Advancing beyond last token");return this.pos+=t.length,this.skipSpaces(),t}consume(t){if(this.take()!=t)throw new Error("Token mismatch")}skipSpaces(){let t=/^[ \t]*/.exec(this.str.substring(this.pos));if(t===null)throw new Error("Erro de espa\xE7o em branco.");this.pos+=t[0].length}},c=class s extends Error{constructor(t,e,n){super(t),this.start=e,this.end=n,Object.setPrototypeOf(this,s.prototype)}},M=class{constructor(t,e){this.leftSide=t.slice(),this.rightSide=e.slice()}getElements(){let t=new Set;for(let e of this.leftSide.concat(this.rightSide))e.getElements(t);return Array.from(t)}toHtml(t){if(t!==void 0&&t.length!=this.leftSide.length+this.rightSide.length)throw new RangeError("Mismatched number of coefficients");let e=document.createDocumentFragment(),n=0;function o(r){let i=!0;for(let a of r){let l=t!==void 0?t[n]:1;if(l!=0){if(i?i=!1:e.append(f("plus"," + ")),l!=1){let u=f("coefficient",l.toString().replace(/-/,v));l<0&&u.classList.add("negative"),e.append(u)}e.append(a.toHtml())}n++}}return o(this.leftSide),e.append(f("rightarrow"," \u2192 ")),o(this.rightSide),e}},H=class{constructor(t,e){if(t.length==0&&e!=-1)throw new RangeError("Invalid term");this.items=t.slice(),this.charge=e}getElements(t){t.add("e");for(let e of this.items)e.getElements(t)}countElement(t){if(t=="e")return-this.charge;{let e=0;for(let n of this.items)e=d(e,n.countElement(t));return e}}toHtml(){let t=f("term");if(this.items.length==0&&this.charge==-1)t.textContent="e",t.append(m("sup",v));else{for(let e of this.items)t.append(e.toHtml());if(this.charge!=0){let e;Math.abs(this.charge)==1?e="":e=Math.abs(this.charge).toString(),this.charge>0?e+="+":e+=v,t.append(m("sup",e))}}return t}},N=class{constructor(t,e){if(e<1)throw new RangeError("Assertion error: Count must be a positive integer");this.items=t.slice(),this.count=e}getElements(t){for(let e of this.items)e.getElements(t)}countElement(t){let e=0;for(let n of this.items)e=d(e,p(n.countElement(t),this.count));return e}toHtml(){let t=f("group","(");for(let e of this.items)t.append(e.toHtml());return t.append(")"),this.count!=1&&t.append(m("sub",this.count.toString())),t}},R=class{constructor(t,e){if(this.name=t,this.count=e,e<1)throw new RangeError("Assertion error: Count must be a positive integer")}getElements(t){t.add(this.name)}countElement(t){return t==this.name?this.count:0}toHtml(){let t=f("element",this.name);return this.count!=1&&t.append(m("sub",this.count.toString())),t}},A=class s{constructor(t,e){if(this.numRows=t,this.numCols=e,t<0||e<0)throw new RangeError("Illegal argument");let n=[];for(let o=0;o<e;o++)n.push(0);this.cells=[];for(let o=0;o<t;o++)this.cells.push(n.slice())}get(t,e){if(t<0||t>=this.numRows||e<0||e>=this.numCols)throw new RangeError("Index out of bounds");return this.cells[t][e]}set(t,e,n){if(t<0||t>=this.numRows||e<0||e>=this.numCols)throw new RangeError("Index out of bounds");this.cells[t][e]=n}swapRows(t,e){if(t<0||t>=this.numRows||e<0||e>=this.numRows)throw new RangeError("Index out of bounds");let n=this.cells[t];this.cells[t]=this.cells[e],this.cells[e]=n}static addRows(t,e){let n=[];for(let o=0;o<t.length;o++)n.push(d(t[o],e[o]));return n}static multiplyRow(t,e){return t.map(n=>p(n,e))}static gcdRow(t){let e=0;for(let n of t)e=w(n,e);return e}static simplifyRow(t){let e=0;for(let o of t)if(o!=0){e=Math.sign(o);break}if(e==0)return t.slice();let n=s.gcdRow(t)*e;return t.map(o=>o/n)}gaussJordanEliminate(){let t=this.cells=this.cells.map(s.simplifyRow),e=0;for(let n=0;n<this.numCols;n++){let o=e;for(;o<this.numRows&&t[o][n]==0;)o++;if(o==this.numRows)continue;let r=t[o][n];this.swapRows(e,o),e++;for(let i=e;i<this.numRows;i++){let a=w(r,t[i][n]);t[i]=s.simplifyRow(s.addRows(s.multiplyRow(t[i],r/a),s.multiplyRow(t[n],-t[i][n]/a)))}}for(let n=this.numRows-1;n>=0;n--){let o=0;for(;o<this.numCols&&t[n][o]==0;)o++;if(o==this.numCols)continue;let r=t[n][o];for(let i=n-1;i>=0;i--){let a=w(r,t[i][o]);t[i]=s.simplifyRow(s.addRows(s.multiplyRow(t[i],r/a),s.multiplyRow(t[n],-t[i][o]/a)))}}}};function j(s){let t=s.getElements(),e=s.leftSide,n=s.rightSide,o=new A(t.length+1,e.length+n.length+1);return t.forEach((r,i)=>{let a=0;for(let l of e)o.set(i,a,l.countElement(r)),a++;for(let l of n)o.set(i,a,-l.countElement(r)),a++}),o}function J(s){s.gaussJordanEliminate();function t(n){let o=0;for(let r=0;r<s.numCols;r++)s.get(n,r)!=0&&o++;return o}let e;for(e=0;e<s.numRows-1&&!(t(e)>1);e++);if(e==s.numRows-1)throw new RangeError("Formula sem solu\xE7\xE3o");s.set(s.numRows-1,e,1),s.set(s.numRows-1,s.numCols-1,1),s.gaussJordanEliminate()}function $(s){let t=s.numRows,e=s.numCols;if(e-1>t||s.get(e-2,e-2)==0)throw new RangeError("Multiple independent solutions");let n=1;for(let r=0;r<e-1;r++)n=p(n/w(n,s.get(r,r)),s.get(r,r));let o=[];for(let r=0;r<e-1;r++)o.push(p(n/s.get(r,r),s.get(r,e-1)));if(o.every(r=>r==0))throw new RangeError("Assertion error: All-zero solution");return o}function G(s,t){if(t.length!=s.leftSide.length+s.rightSide.length)throw new Error("Assertion error: Mismatched length");function e(n){if(typeof n!="number"||isNaN(n)||Math.floor(n)!=n)throw new Error("Assertion error: Not an integer");return n==0}if(t.every(e))throw new Error("Assertion error: All-zero solution");for(let n of s.getElements()){let o=0,r=0;for(let i of s.leftSide)o=d(o,p(i.countElement(n),t[r])),r++;for(let i of s.rightSide)o=d(o,p(i.countElement(n),-t[r])),r++;if(o!=0)throw new Error("Assertion error: Incorrect balance")}}var L=9007199254740992;function V(s){let t=parseInt(s,10);if(isNaN(t))throw new RangeError("Not a number");return S(t)}function d(s,t){return S(s+t)}function p(s,t){return S(s*t)}function S(s){if(Math.abs(s)>=L)throw new RangeError("Arithmetic overflow");return s}function w(s,t){if(typeof s!="number"||typeof t!="number"||isNaN(s)||isNaN(t))throw new Error("Invalid argument");for(s=Math.abs(s),t=Math.abs(t);t!=0;){let e=s%t;s=t,t=e}return s}var v="\u2212";function m(s,t){let e=document.createElement(s);return t!==void 0&&(e.textContent=t),e}function f(s,t){let e=m("span",t);return e.className=s,e}export{q as ChemBalanceComponent};
